---
lab:
  az204Title: 'Lab 08: Create a multi-tier solution by using Azure services'
  az020Title: 'Lab 08: Create a multi-tier solution by using Azure services'
  az204Module: 'Module 08: Implement API Management'
  az020Module: 'Module 08: Implement API Management'
ms.openlocfilehash: b613922babbf2f7cf5dacbcd7fef8f3b7193500e
ms.sourcegitcommit: 9abfe3b5a1c9ccd2f0610348052d04169573f81a
ms.translationtype: HT
ms.contentlocale: id-ID
ms.lasthandoff: 06/01/2022
ms.locfileid: "145995025"
---
# <a name="lab-08-create-a-multi-tier-solution-by-using-azure-services"></a>Lab 08: Membuat solusi multi-tingkat dengan menggunakan Azure Policy

## <a name="microsoft-azure-user-interface"></a>Antarmuka pengguna Microsoft Azure

Mengingat sifat dinamis dari alat cloud Microsoft, Anda mungkin mengalami perubahan antarmuka pengguna Azure yang terjadi setelah pengembangan konten pelatihan ini. Akibatnya, instruksi lab dan langkah-langkah lab mungkin tidak selaras dengan benar.

Microsoft memperbarui kursus pelatihan ini ketika komunitas memberi tahu kami tentang perubahan yang diperlukan. Tetapi, pembaruan cloud sering terjadi, sehingga Anda mungkin mengalami perubahan antarmuka pengguna sebelum pembaruan konten pelatihan ini. **Jika hal ini terjadi, sesuaikan dengan perubahan, lalu kerjakan perubahan di lab sesuai kebutuhan.**


## <a name="instructions"></a>Instruksi

### <a name="before-you-start"></a>Sebelum Anda memulai

#### <a name="sign-in-to-the-lab-environment"></a>Masuk ke lingkungan lab

Masuk ke mesin virtual (VM) Windows 10 Anda menggunakan kredensial berikut:
    
-   Nama pengguna: **Admin**

-   Kata sandi: **Pa55w.rd**

> **Catatan**: Instruktur Anda akan memberikan instruksi untuk terhubung ke lingkungan lab virtual.

#### <a name="review-the-installed-applications"></a>Meninjau aplikasi yang diinstal

Temukan taskbar di desktop Windows 10 Anda. Bilah tugas berisi ikon untuk aplikasi yang akan Anda gunakan di lab ini:
    
-   Microsoft Edge

## <a name="architecture-diagram"></a>Diagram arsitektur

![Diagram arsitektur yang menggambarkan pembuatan aplikasi multi-tingkat dengan menggunakan layanan Azure.](./media/Lab08-Diagram.png)

### <a name="exercise-1-create-an-azure-app-service-resource-by-using-a-docker-container-image"></a>Latihan 1: Membuat sumber daya Azure App Service dengan menggunakan gambar kontainer Docker

#### <a name="task-1-open-the-azure-portal"></a>Tugas 1: Membuka portal Azure

1.  Pada taskbar, pilih ikon **Microsoft Edge**.

1.  Di jendela browser yang terbuka, jelajahi portal Azure ([portal.azure.com](https://portal.azure.com)), lalu masuk dengan akun yang akan Anda gunakan untuk lab ini.

    > **Catatan**: Jika ini pertama kalinya Anda masuk ke portal Microsoft Azure, Anda akan diberikan penawaran tur portal. Pilih **Memulai** untuk melewati tur dan mulai menggunakan portal.

#### <a name="task-2-create-a-web-app-by-using-azure-app-service-resource-by-using-an-httpbin-container-image"></a>Tugas 2: Membuat aplikasi web menggunakan sumber daya Azure App Service dengan gambar kontainer httpbin

1.  Di portal Microsoft Azure, gunakan kotak teks **Cari sumber daya, layanan, dan dokumen** untuk menelusuri **App Services** dan, dalam daftar hasil, pilih **App Services**.

1.  Pada panel **App Services**, pilih **+ Buat**.

1.  Pada bilah **Buat Aplikasi Web**, pada tab **Dasar**, lakukan tindakan berikut:
    
    | Pengaturan | Tindakan |
    | -- | -- |
    | Daftar menurun **Langganan** | Pertahankan nilai default |
    | Bagian **Grup sumber daya** | Pilih **Buat baru**, masukkan **ApiService**, lalu pilih **OK** |
    | Kotak teks **Nama** | Masukkan **httpapi** *[namaanda]* |
    | Bagian **Perenerbitan** | Pilih **Kontainer Docker** |
    | Bagian **Sistem Operasi** | Pilih **Linux** |
    | Daftar menurun **Wilayah** | Pilih wilayah Azure tempat Anda dapat menerapkan aplikasi web Azure |
    | Bagian **Paket App Service** | Pilih **Buat baru**, masukkan nilai **ApiPlan** di kotak teks **Nama**, lalu pilih **OK** |
    | Bagian **SKU dan ukuran** | Pilih **Ubah ukuran**, pada panel **Pemilih Spesifikasi**, pilih **Lihat opsi tambahan**, pilih **S1**, lalu pilih **Terapkan** |

1.  Pilih **Berikutnya: Docker >** .

1.  Pada tab **Docker**, lakukan tindakan berikut, lalu pilih **Tinjauan + buat**:

    | Pengaturan | Tindakan |
    | -- | -- |
    | Daftar menurun **Opsi** | Pilih **Kontainer Tunggal** |
    | Daftar menurun **Sumber Gambar** | Pilih **Hub Docker** |
    | Daftar menurun **Jenis Akses** | Pilih **Publik** |
    | Kotak teks **Gambar dan tag** | Masukkan **kennethreitz/httpbin:latest** |

1.  Pada tab **Tinjauan + buat**, tinjau opsi yang Anda pilih di langkah sebelumnya.

1.  Pilih **Buat** untuk membuat aplikasi web dengan menggunakan konfigurasi yang Anda tentukan.

    > **Catatan**: Tunggu hingga tugas pembuatan selesai sebelum Anda melanjutkan ke lab ini.

#### <a name="task-3-test-the-httpbin-web-application"></a>Tugas 3: Menguji aplikasi web httpbin

1.  Di portal Microsoft Azure, gunakan kotak teks **Cari sumber daya, layanan, dan dokumen** untuk menelusuri **App Services** dan, dalam daftar hasil, pilih **App Services**.

1.  Pada panel **App Services**, pilih aplikasi web yang baru dibuat.

1.  Pada bilah yang menampilkan properti aplikasi yang baru dibuat, pilih **Jelajahi**.

1.  Dalam aplikasi web, lakukan tindakan berikut:

    a.  Pilih **Format tanggapan**.

    b.  Pilih **GET /html**.

    c.  Pilih **Coba**.

    Tangkapan layar berikut menampilkan bagian **Coba** dari aplikasi web.

    ![Halaman API httpbin.org GET / bagian coba html](./media/l08_httpbin_get_html_try.png)

    d.  Pilih **Jalankan**.

    e.  Tinjauan nilai kotak teks **Isi respons** dan **Header respons**.

    f.  Tinjauan nilai kotak teks **Minta URL**.

1.  Dalam aplikasi web, lakukan tindakan berikut:

    a.  Pilih **Data dinamis**.

    b.  Pilih **GET /byte/{n}** .

    c.  Pilih **Coba**.

    d.  Di kotak teks **n**, masukkan **25**.

    e.  Pilih **Jalankan**.

    f.  Tinjauan nilai kotak teks **Isi respons** dan **Header respons**.

    g.  Pilih **Unduh file**, dan setelah file diunduh, buka di Notepad, tinjau kontennya, lalu tutup.

    > **Catatan**: File berisi urutan byte yang dihasilkan secara acak.

    Tangkapan layar berikut menampilkan bagian data dinamis aplikasi web.
  
    ![httpbin.org halaman API GET /bytes/{n} bagian data dinamis](./media/l08_response_to_dynamic_data.png)

1.  Dalam aplikasi web, lakukan tindakan berikut:

    a.  Pilih **Kode status**.

    b.  Pilih **GET /status/{codes}** .

    c.  Pilih **Coba**.

    d.  Di kotak teks **kode**, masukkan **404**.

    e.  Pilih **Jalankan**.

    f.  Tinjauan **Respons server** dan perhatikan bahwa ini mencakup **Kesalahan: entri TIDAK DITEMUKAN**.
     
1.  Tutup jendela browser yang menampilkan aplikasi web.

1.  Beralih kembali ke jendela browser yang menampilkan aplikasi web **httpapi** _[namaanda]_.

1.  Di bagian **Pengaturan**, pilih tautan **Properti**.

1.  Di bagian **Properti**, catat nilai tautan **URL**. Anda akan menggunakan nilai ini nanti di lab untuk mengirim permintaan ke API yang sesuai.

#### <a name="review"></a>Tinjauan

Dalam latihan ini, Anda membuat aplikasi web Azure baru dengan menggunakan gambar kontainer yang bersumber dari Docker Hub.

### <a name="exercise-2-build-an-api-proxy-tier-by-using-azure-api-management"></a>Latihan 2: Membangun tingkat proksi API dengan menggunakan Azure API Management

#### <a name="task-1-create-an-api-management-resource"></a>Tugas 1: Membuat sumber daya API Management

1.  Di portal Microsoft Azure, gunakan kotak teks **Cari sumber daya, layanan, dan dokumen** untuk mencari **layanan API Management** dan, dalam daftar hasil, pilih **layanan API Management**.

1.  Pada panel **Layanan API Management**, pilih **+ Buat**.

1.  Pada panel **Pasang gerbang API Management**, lakukan tindakan berikut, lalu pilih **Tinjauan + buat**:

    
    | Pengaturan | Tindakan |
    | -- | -- |
    | Daftar menurun **Langganan** | Pertahankan nilai default. |
    | Bagian **Grup sumber daya** | Pilih grup **ApiService** yang Anda buat sebelumnya di lab |
    | Daftar **Wilayah** | Pilih wilayah yang sama dengan yang Anda pilih di latihan sebelumnya |
    | Kotak teks **Nama sumber daya** | Masukkan **proapi** *[namaanda]* |
    | kotak teks **Nama organisasi** | Masukkan **Contoso** |
    | Kotak teks **Email administrator** | Masukkan `admin@contoso.com` |
    | Daftar menurun **Tingkat harga** | **Konsumsi (99,95% SLA)** |

    Tangkapan layar berikut menampilkan pengaturan yang dikonfigurasi dari bilah **Buat API Management** dari aplikasi web.
    
    ![Membuat bilah API Management](./media/l08_create_api_management.png)

1.  Pada tab **Tinjauan + buat**, tinjau opsi yang Anda tentukan di langkah sebelumnya, lalu pilih **Buat**.

    > **Catatan**: Tunggu hingga tugas pembuatan selesai sebelum Anda melanjutkan dengan lab ini.

1. Pada panel **Gambaran Umum Penyebaran**, pilih **Buka sumber daya**.

#### <a name="task-2-define-a-new-api"></a>Tugas 2: Menentukan API baru

1.  Pada panel **API Management Service**, di bagian **API**, pilih **API**.

1.  Di bagian **Tentukan API baru**, pilih **HTTP**.

1.  Di jendela **Buat API HTTP**, lakukan tindakan berikut dan pilih **Buat**:
    
    | Pengaturan | Tindakan |
    | --------------------------------- | ------------------------------------------------------------ |
    | Kotak teks **Nama tampilan** | Masukkan **HTTPBin API** |
    | Kotak teks **Nama** | Masukkan **httpbin-api** |
    | Kotak teks **URL layanan web** | Masukkan URL aplikasi web yang Anda salin sebelumnya di lab ini. **Catatan**: Pastikan URL dimulai dengan awalan `https://` |
    | kotak teks **akhiran URL API** | Biarkan kosong |
 
    Tangkapan layar berikut menampilkan pengaturan yang dikonfigurasi dari jendela **Buat API kosong** dari aplikasi web.

    ![Membuat panel API kosong](./media/l08_create_blank_api.png)

    > **Catatan**: Tunggu hingga API baru selesai dibuat.

1.  Pada tab **Desain**, pilih **+ Tambahkan operasi**.

1.  Di bagian **Tambahkan operasi**, lakukan tindakan berikut, lalu pilih **Simpan**:


    | Pengaturan | Tindakan |
    | -- | -- |
    | Kotak teks **Nama tampilan** | Masukkan **Header Echo** |
    | Kotak teks **Nama** | Verifikasi bahwa nilainya diatur ke **echo-headers** |
    | Daftar **URL** | Pilih **GET** |
    | Kotak teks **URL** | Masukkan **/** |

    Tangkapan layar berikut menampilkan pengaturan yang dikonfigurasi dari bagian **Tambahkan operasi**.
    
    ![Properti dari operasi Tambahkan Header Echo](./media/l08_add_echo_headers_operation.png)

    
1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Header Echo** .

1.  Di bagian **Desain**, pada ubin **Pemrosesan masuk** pilih **+ Tambahkan kebijakan**.

1.  Di bagian **Tambahkan kebijakan masuk**, pilih ubin **Atur header**.

1.  Di bagian **Atur Header**, lakukan tindakan berikut, lalu pilih **Simpan**:
    
    | Pengaturan | Tindakan  |
    | --- | --- |
    | Kotak teks **Nama**    | Masukkan **sumber**|
    | kotak teks **Nilai** | Pilih daftar, pilih **Tambahkan Nilai**, lalu masukkan **azure-api-mgmt**|
    | Daftar **Tindakan**        | Pilih **tambahkan**|

    Tangkapan layar berikut menampilkan pengaturan yang dikonfigurasi dari bagian **Desain**.

    ![Panel desain Header Echo](./media/l08_get_echo_headers_design.png)

1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Header Echo** .

1.  Di bagian **Desain** untuk **Header Echo**, pada ubin **Backend**, pilih ikon pensil.

1.  Di bagian **Backend**, lakukan tindakan berikut, lalu pilih **Simpan**:

    | Pengaturan | Tindakan |
    | -- | -- |
    | Bagian **Layanan URL** | Pilih kotak centang **Ganti** |
    | kotak teks **Layanan URL** | Tambahkan nilai **/header** ke nilai saat ini. **Catatan**: Misalnya, jika nilai saat ini adalah `http://httpapi[yourname].azurewebsites.net`, nilai baru akan menjadi `http://httpapi[yourname].azurewebsites.net/headers` |
    
1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Header Echo**, lalu pilih tab **Uji**.

1.  Di bagian **Header Echo**, pilih **Kirim**.

    Tangkapan layar berikut menampilkan pengaturan yang dikonfigurasi dari bagian **Header Echo**.

    ![Tab Uji Header Echo](./media/l08_test_echo_headers.png)
    
1.  Tinjauan hasil permintaan API.

    > **Catatan**: Verifikasi bahwa ada banyak header yang dikirim sebagai bagian dari permintaan Anda yang digaungkan dalam respons. Mereka harus menyertakan header **Sumber** baru yang Anda buat sebagai bagian dari tugas ini.
     
    Tangkapan layar berikut menampilkan respons terhadap permintaan **Header Echo**.

    ![Respons terhadap permintaan header gema pengujian](./media/l08_response_to_echo_headers.png)
     
1.  Pilih tab **Desain** untuk kembali ke daftar operasi.

#### <a name="task-3-manipulate-an-api-response"></a>Tugas 3: Memanipulasi respons API

1.  Pada tab **Desain**, pilih **+ Tambahkan operasi**.

1.  Di bagian **Tambahkan operasi**, lakukan tindakan berikut, lalu pilih **Simpan**:

    | Pengaturan | Tindakan |
    | -- | -- |
    | Kotak teks **Nama tampilan** | Masukkan **Dapatkan Data Lama** |
    | Kotak teks **Nama** | Verifikasi bahwa nilainya diatur ke **get-legacy-data** |
    | Daftar **URL** | Verifikasi bahwa nilainya diatur ke **GET** |
    | Kotak teks **URL** | Masukkan **/xml** |

1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Dapatkan Data Lama**.

1.  Pilih tab **Uji**, lalu pilih **Kirim**.

1.  Tinjauan hasil permintaan API.

    > **Catatan**: Pada titik ini, hasilnya harus dalam format XML.

    Tangkapan layar berikut menampilkan hasil permintaan API.
    
    ![Tanggapan untuk mendapatkan permintaan data lama](./media/l08_response_to_get_legacy_data.png)

    
1.  Pilih tab **Desain**, lalu pilih **Dapatkan Data Lama**.

1.  Pada panel **Desain**, di bagian **Pemrosesan keluar**, pilih **Tambahkan kebijakan**.
    
    Tangkapan layar berikut menampilkan bagian **Pemrosesan keluar**.
    
    ![Bagian pemrosesan keluar dari operasi dapatkan data lama](./media/l08_get_legacy_data_outbound_processing.png)
    
1.  Di bagian **Tambahkan kebijakan keluar**, pilih ubin **Kebijakan lainnya**.

1.  Di editor kode kebijakan, temukan blok konten XML berikut:

    ```
    <outbound>
        <base />
    </outbound>
    ```

1.  Ganti blok XML dengan XML berikut:

    ```
    <outbound>
        <base />
        <xml-to-json kind="direct" apply="always" consider-accept-header="false" />
    </outbound>
    ```

1.  Di editor kode kebijakan, pilih **Simpan**.

1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Dapatkan Data Lama**, lalu pilih **Uji**.

1.  Di bagian **Dapatkan Data Lama**, pilih **Kirim**.

1.  Tinjauan hasil permintaan API.

    > **Catatan**: Hasil baru dalam format JavaScript Object Notation (JSON).

1.  Dalam bagian **Respons HTTP**, lakukan tindakan berikut:

    1.  Pilih **Lacak**.

    1.  Tinjauan konten di kotak teks **Backend** dan **Keluar**, dan perhatikan bahwa keduanya menyertakan detail operasi API yang sesuai dengan informasi waktunya.

#### <a name="task-4-manipulate-an-api-request"></a>Tugas 4: Memanipulasi permintaan API

1.  Pada tab **Desain**, pilih **+ Tambahkan operasi**.

1.  Di bagian **Tambahkan operasi**, lakukan tindakan berikut, lalu pilih **Simpan**:

    | Pengaturan  | Tindakan |
    | -- | -- |
    | Kotak teks **Nama tampilan** | Masukkan **Ubah Kode Status** |
    | Kotak teks **Nama** | Verifikasi bahwa nilainya diatur ke **modify-status-code** |
    | Daftar **URL** | Pilih **GET** |
    | Kotak teks **URL** | Masukkan **/status/404** |

1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Ubah Kode Status**.

1.  Di bagian **Desain**, pada ubin **Pemrosesan masuk**, pilih **+ Tambahkan kebijakan**.

1.  Di bagian **Tambahkan kebijakan masuk**, pilih ubin **Tulis ulang URL**.

1.  Di bagian **Tulis Ulang URL**, lakukan tindakan berikut:
       
    a.  Di kotak teks **Backend**, masukkan **/status/200**.
    
    b.  Pilih **Simpan**.

1.  Kembali ke tab **Desain**, dalam daftar operasi, pilih **Ubah Kode Status**, lalu pilih tab **Uji**.
    
1.  Di bagian **Ubah Kode Status**, pilih **Kirim**.

1.  Tinjauan hasil permintaan API.

    > **Catatan**: Verifikasi bahwa permintaan memunculkan respons **HTTP/1.1 200 OK**.
   
#### <a name="review"></a>Tinjauan

Dalam latihan ini, Anda membuat tingkat proksi antara sumber daya App Service dan pengembang mana pun yang ingin membuat kueri terhadap API-nya.

### <a name="exercise-3-clean-up-your-subscription"></a>Latihan 3: Membersihkan langganan Anda

#### <a name="task-1-open-azure-cloud-shell"></a>Tugas 1: Membuka Azure Cloud Shell

1.  Di portal Microsoft Azure, pilih ikon **Cloud Shell** ![ikon Cloud Shell](./media/az204_lab_CloudShell.png) untuk membuka sesi Bash baru. Jika Cloud Shell diatur default ke sesi PowerShell, pilih **PowerShell**, dan di menu drop-down, pilih **Bash**.

      > **Catatan**: Jika ini pertama kalinya Anda memulai **Cloud Shell**, saat diminta untuk memilih **Bash** atau **PowerShell**, pilih **PowerShell**. Saat Anda melihat pesan **Anda tidak memiliki penyimpanan yang terpasang**, pilih langganan yang Anda gunakan di lab ini, lalu pilih **Buat penyimpanan**.

#### <a name="task-2-delete-resource-groups"></a>Tugas 2: Menghapus grup sumber daya

1.  Pada panel **Cloud Shell**, jalankan perintah berikut untuk menghapus grup sumber daya **ApiService**:

    ```
    az group delete --name ApiService --no-wait --yes
    ```
    
     > **Catatan**: Perintah dijalankan secara asinkron (seperti yang ditentukan oleh parameter *--no-wait*), jadi meskipun Anda dapat menjalankan perintah Azure CLI lain segera setelahnya dalam sesi Bash yang sama, akan memakan waktu beberapa menit sebelum grup sumber daya benar-benar dihapus.
  
1.  Tutup panel **Cloud Shell** di portal.

#### <a name="task-3-close-the-active-applications"></a>Tugas 3: Menutup aplikasi yang aktif

1.  Tutup aplikasi Microsoft Edge yang sedang berjalan.

#### <a name="review"></a>Tinjauan

Dalam latihan ini, Anda membersihkan langganan Anda dengan menghapus grup sumber daya yang digunakan di lab ini.