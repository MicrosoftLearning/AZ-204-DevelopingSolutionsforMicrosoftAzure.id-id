---
lab:
  az204Title: 'Lab 02: Implement task processing logic by using Azure Functions'
  az020Title: 'Lab 02: Implement task processing logic by using Azure Functions'
  az204Module: 'Module 02: Implement Azure Functions'
  az020Module: 'Module 02: Implement Azure Functions'
ms.openlocfilehash: ff0481047e07f398061649d06991fb8ab0d481c3
ms.sourcegitcommit: 412902a597da51fc2af04a5fa4ddb787200c028c
ms.translationtype: HT
ms.contentlocale: id-ID
ms.lasthandoff: 06/07/2022
ms.locfileid: "146181461"
---
# <a name="lab-02-implement-task-processing-logic-by-using-azure-functions"></a>Lab 02: Menerapkan logika pemrosesan tugas menggunakan Azure Functions

## <a name="microsoft-azure-user-interface"></a>Antarmuka pengguna Microsoft Azure

Mengingat sifat dinamis dari alat cloud Microsoft, Anda mungkin mengalami perubahan antarmuka pengguna Azure yang terjadi setelah pengembangan konten pelatihan ini. Akibatnya, instruksi lab dan langkah-langkah lab mungkin tidak selaras dengan benar.

Microsoft memperbarui kursus pelatihan ini ketika komunitas memberi tahu kami tentang perubahan yang diperlukan. Tetapi, pembaruan cloud sering terjadi, sehingga Anda mungkin mengalami perubahan antarmuka pengguna sebelum pembaruan konten pelatihan ini. **Jika hal ini terjadi, sesuaikan dengan perubahan, lalu kerjakan perubahan di lab sesuai kebutuhan.**

## <a name="instructions"></a>Petunjuk

### <a name="before-you-start"></a>Sebelum memulai

#### <a name="sign-in-to-the-lab-environment"></a>Masuk ke lingkungan lab

Masuk ke mesin virtual (VM) Windows 10 Anda menggunakan kredensial berikut:

- Nama pengguna: **Admin**
- Kata sandi: **Pa55w.rd**

> **Catatan**: Instruktur Anda akan memberikan instruksi untuk terhubung ke lingkungan lab virtual.

#### <a name="review-the-installed-applications"></a>Meninjau aplikasi yang diinstal

Temukan taskbar di desktop Windows 10 Anda. Taskbar berisi ikon untuk aplikasi yang akan Anda gunakan di lab ini, termasuk:

- Microsoft Edge
- File Explorer
- Windows Terminal
- Visual Studio Code

## <a name="architecture-diagram"></a>Diagram arsitektur

![Diagram arsitektur yang menggambarkan pengguna yang menerapkan logika pemrosesan tugas dengan menggunakan Azure Functions.](./media/Lab02-Diagram.png)

### <a name="exercise-1-create-azure-resources"></a>Latihan 1: Membuat sumber daya Azure

#### <a name="task-1-open-the-azure-portal"></a>Tugas 1: Membuka portal Microsoft Azure

1. Pada taskbar, pilih ikon **Microsoft Edge**.
1. Di jendela browser, jelajahi portal Microsoft Azure (<https://portal.azure.com>), lalu masuk dengan akun yang akan Anda gunakan untuk lab ini.

    > **Catatan**: Jika ini pertama kalinya Anda masuk ke portal Microsoft Azure, Anda akan diberikan penawaran tur portal. Jika Anda memilih untuk melewati tur, pilih **Memulai** untuk mulai menggunakan portal.

#### <a name="task-2-create-an-azure-storage-account"></a>Tugas 2: Membuat akun Azure Storage

1. Di portal Microsoft Azure, gunakan kotak teks **Cari sumber daya, layanan, dan dokumen** untuk mencari **Akun Penyimpanan**, lalu, di daftar hasil, pilih **Akun Penyimpanan**.

1. Pada panel **Akun penyimpanan**, pilih **+ Buat**.

1. Pada panel **Buat akun penyimpanan**, pada tab **Dasar**, lakukan tindakan berikut, lalu pilih **Tinjau + buat**:

    | Pengaturan                           | Tindakan                                                       |
    | --------------------------------- | ------------------------------------------------------------ |
    | Daftar dropdown **Langganan**   | Pertahankan nilai default.                                    |
    | Bagian **Grup sumber daya**        | Pilih **Buat baru**, masukkan **Tanpa Server**, lalu pilih **OK**. |
    | Kotak teks **Nama akun penyimpanan** | Masukkan **funcstor** _[namaanda]_ .                              |
    | Daftar drop-down **Wilayah**         | Pilih **(AS) US Timur**.                                     |
    | Bagian **Performa**           | Pilih opsi **Standar**.                              |
    | Daftar dropdown **Redundansi**     | Pilih **Penyimpanan redundan secara lokal (LRS)** .                  |

    Cuplikan layar berikut menampilkan pengaturan yang dikonfigurasi di panel **Buat akun penyimpanan**.

    ![Cuplikan layar yang menampilkan pengaturan yang dikonfigurasi pada panel Buat akun penyimpanan](./media/l02_create_a_storage_account.png)

1. Pada tab **Tinjau + buat**, tinjau opsi yang Anda pilih di langkah sebelumnya. sebelumnya.

1. Pilih **Buat** untuk membuat akun penyimpanan menggunakan konfigurasi yang Anda tentukan.

    > **Catatan**: Tunggu hingga tugas pembuatan selesai sebelum Anda melanjutkan ke lab ini.

1. Pada panel **Gambaran Umum**, pilih tombol **Buka sumber daya** untuk menavigasi ke panel akun penyimpanan yang baru dibuat.

1. Pada panel **Akun penyimpanan**, di bagian **Keamanan + jaringan**, pilih **Kunci akses**.

1. Pada panel **kunci akses**, pilih **Tampilkan kunci**.

1. Tinjau salah satu kunci, lalu salin nilai salah satu kotak **String koneksi** ke clipboard.

     > **Catatan**: Tidak masalah string koneksi mana yang Anda pilih. Ini dapat dipertukarkan.

1. Buka Notepad, lalu tempel nilai string koneksi yang disalin ke Notepad. Anda akan menggunakan nilai ini nanti di lab ini.

#### <a name="task-3-create-a-function-app"></a>Tugas 3: Buat aplikasi fungsi

1. Di panel navigasi portal Microsoft Azure, pilih tautan **Buat sumber daya**.

1. Pada panel **Buat sumber daya**, di kotak teks **Layanan pencarian dan marketplace**, masukkan **Fungsi**, lalu pilih Enter.

1. Pada panel hasil pencarian **Marketplace**, pilih hasil **Aplikasi Fungsi**.

1. Pada panel **Aplikasi Fungsi**, pilih **Buat**.

1. Pada panel **Buat Aplikasi Fungsi**, pada tab **Dasar**, lakukan tindakan berikut, lalu pilih **Berikutnya: Hosting**:

    | Pengaturan                          | Tindakan                           |
    | -------------------------------- | -------------------------------- |
    | Daftar dropdown **Langganan**  | Pertahankan nilai default.        |
    | Bagian **Grup sumber daya**       | Pilih **Tanpa Server**.           |
    | Kotak teks **Nama Aplikasi Fungsi**   | Masukkan **funclogic** _[namaanda]_ . |
    | Bagian **Perenerbitan**              | Pilih **Kode**.                 |
    | Daftar drop-down **Tumpukan runtime** | Pilih **.NET**.                |
    | Daftar dropdown **Versi**       | Pilih **3.1**.                  |
    | Daftar drop-down **Wilayah**        | Pilih wilayah **US Timur**.   |
    | Bagian **Sistem Operasi**     | Pilih **Linux**.                                  |
    | Daftar drop-down **Jenis paket**     | Pilih **Konsumsi (Tanpa Server)** .               |

    Cuplikan layar berikut menampilkan pengaturan yang dikonfigurasi di panel **Buat Aplikasi Fungsi**.

    ![Cuplikan layar yang menampilkan pengaturan yang dikonfigurasi pada panel Buat Aplikasi Fungsi](./media/l02_create_a_function_app.png)

1. Pada tab **Hosting**, lakukan tindakan berikut, lalu pilih **Tinjau + buat**:

    | Pengaturan                            | Tindakan                                             |
    | ---------------------------------- | -------------------------------------------------- |
    | Daftar dropdown **Akun penyimpanan** | Pilih akun penyimpanan **funcstor** _[namaanda]_ . |

    Cuplikan layar berikut menampilkan pengaturan yang dikonfigurasi pada tab **Hosting** pada panel **Buat Aplikasi Fungsi**.

    ![Cuplikan layar yang menampilkan pengaturan yang dikonfigurasi pada tab Hosting di panel Buat Aplikasi Fungsi ](./media/l02_create_a_function_app_hosting_tab.png)

1. Pada tab **Tinjau + buat**, tinjau opsi yang Anda pilih di langkah sebelumnya.

1. Pilih **Buat** untuk membuat aplikasi fungsi menggunakan konfigurasi yang Anda tentukan.

    > **Catatan**: Tunggu hingga tugas pembuatan selesai sebelum Anda melanjutkan dengan lab ini.

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membuat semua sumber daya yang akan Anda gunakan di lab ini.

### <a name="exercise-2-configure-a-local-azure-functions-project"></a>Latihan 2: Mengonfigurasi proyek Azure Functions lokal

#### <a name="task-1-initialize-a-function-project"></a>Tugas 1: Menginisialisasi proyek fungsi

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori kosong **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

    > **Catatan**: Di Windows Explorer hapus atribut **Baca-saja** dari file **F:\\Allfiles\\Labs\\02\\Starter\\func\\.gitignore**.

1. Jalankan perintah berikut untuk menggunakan **Azure Functions Core Tools** guna membuat proyek Azure Functions lokal baru di direktori saat ini menggunakan runtime **dotnet**:

    ```powershell
    func init --worker-runtime dotnet --force
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [create a new project][azure-functions-core-tools-new-project] menggunakan **Azure Functions Core Tools**.
    
1. Tutup aplikasi **Terminal Windows**.

#### <a name="task-2-configure-a-connection-string"></a>Tugas 2: Mengonfigurasi string koneksi

1. Pada layar **Mulai**, pilih petak peta **Visual Studio Code**.

1. Pada menu **File**, pilih **Buka Folder**.

1. Di jendela **File Explorer** yang terbuka, telusuri **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**, lalu **Pilih Folder**.

1. Pada panel **Penjelajah** pada jendela **Visual Studio Code**, buka file **local.settings.json**.

1. Amati nilai saat ini dari pengaturan **AzureWebJobsStorage**:

    ```json
    "AzureWebJobsStorage": "UseDevelopmentStorage=true",
    ```

1. Perbarui nilai **AzureWebJobsStorage** dengan mengaturnya ke **string koneksi** akun penyimpanan yang Anda catat sebelumnya di lab ini.

1. Simpan file **local.settings.json**.

#### <a name="task-3-build-and-validate-a-project"></a>Tugas 3: Membangun dan memvalidasi proyek

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Jalankan perintah berikut untuk **membangun** proyek .NET Core 3.1:

    ```powershell
    dotnet build
    ```

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membuat proyek lokal yang akan Anda gunakan untuk pengembangan Azure Functions.

### <a name="exercise-3-create-a-function-thats-triggered-by-an-http-request"></a>Latihan 3: Membuat fungsi yang dipicu oleh permintaan HTTP

#### <a name="task-1-create-an-http-triggered-function"></a>Tugas 1: Membuat fungsi yang dipicu HTTP

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Jalankan perintah berikut untuk menggunakan **Azure Functions Core Tools** untuk membuat fungsi baru bernama **Echo** menggunakan template **pemicu HTTP**:

    ```powershell
    func new --template "HTTP trigger" --name "Echo"
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [create a new function][azure-functions-core-tools-new-function] menggunakan **Azure Functions Core Tools**.

1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

#### <a name="task-2-write-http-triggered-function-code"></a>Tugas 2: Tulis kode fungsi yang dipicu HTTP

1. Pada layar **Mulai**, pilih petak peta **Visual Studio Code**.

1. Pada menu **File**, pilih **Buka Folder**.

1. Di jendela **File Explorer** yang terbuka, telusuri **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**, lalu **Pilih Folder**.

1. Pada panel **Explorer** dari jendela **Visual Studio Code**, buka file **Echo.cs**.

1. Di penyunting kode, amati contoh penerapan:

    ```csharp
    using System;
    using System.IO;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.Azure.WebJobs.Extensions.Http;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    using Newtonsoft.Json;
    namespace func
    {
        public static class Echo
        {
            [FunctionName("Echo")]
            public static async Task<IActionResult> Run(
                [HttpTrigger(AuthorizationLevel.Function, "get", "post", Route = null)] HttpRequest req,
                ILogger log)
            {
                log.LogInformation("C# HTTP trigger function processed a request.");
                string name = req.Query["name"];
                string requestBody = await new StreamReader(req.Body).ReadToEndAsync();
                dynamic data = JsonConvert.DeserializeObject(requestBody);
                name = name ?? data?.name;
                string responseMessage = string.IsNullOrEmpty(name)
                    ? "This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response."
                    : $"Hello, {name}. This HTTP triggered function executed successfully.";
                return new OkObjectResult(responseMessage);
            }
        }
    }
    ```

1. Hapus semua konten dalam file **Echo.cs**.
1. Tambahkan baris kode berikut untuk menambahkan **using directives** untuk **Microsoft.AspNetCore.Mvc**, **Microsoft.Azure.WebJobs**, **Microsoft.AspNetCore.Http** , dan namespace **Microsoft.Extensions.Logging**:

    ```csharp
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    ```

1. Buat kelas **public static** baru bernama **Echo**:

    ```csharp
    public static class Echo
    { }
    ```

1. Amati kembali file **Echo.cs**, yang sekarang seharusnya menyertakan:

    ```csharp
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    public static class Echo
    { }
    ```

1. Di dalam kelas **Echo**, tambahkan blok kode berikut untuk membuat metode **public static** baru bernama **Run** yang mengembalikan variabel jenis **IActionResult** dan yang juga menggunakan variabel jenis **HttpRequest** dan **ILogger** sebagai parameter bernama *permintaan* dan *pencatat*:

    ```csharp
    public static IActionResult Run(
        HttpRequest request,
        ILogger logger)
    { }
    ```

1. Tambahkan kode berikut untuk menambahkan atribut ke metode **Run** jenis **FunctionNameAttribute** yang parameter **name**-nya diatur ke nilai **Echo** :

    ```csharp
    [FunctionName("Echo")]
    public static IActionResult Run(
        HttpRequest request,
        ILogger logger)
    { }
    ```

1. Tambahkan kode berikut untuk menambahkan atribut ke parameter **request** jenis **HttpTriggerAttribute** yang memiliki array parameter **methods** yang diatur ke nilai tunggal **POST**:

    ```csharp
    [FunctionName("Echo")]
    public static IActionResult Run(
        [HttpTrigger("POST")] HttpRequest request,
        ILogger logger)
    { }
    ```

1. Amati kembali file **Echo.cs**, yang seharusnya menyertakan kode berikut:

    ```csharp
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    public static class Echo
    {
        [FunctionName("Echo")]
        public static IActionResult Run(
            [HttpTrigger("POST")] HttpRequest request,
            ILogger logger)
        { }
    }
    ```

1. Dalam metode **Run**, masukkan baris kode berikut untuk mencatat pesan tetap:

    ```csharp
    logger.LogInformation("Received a request");
    ```

1. Masukkan baris kode berikut untuk menggemakan isi permintaan HTTP sebagai respons HTTP:

    ```csharp
    return new OkObjectResult(request.Body);
    ```

1. Amati kembali file **Echo.cs**, yang seharusnya menyertakan kode berikut:

    ```csharp
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    public static class Echo
    {
        [FunctionName("Echo")]
        public static IActionResult Run(
            [HttpTrigger("POST")] HttpRequest request,
            ILogger logger)
        {
            logger.LogInformation("Received a request");
            return new OkObjectResult(request.Body);
        }
    }
    ```

1. Pilih **Simpan** untuk menyimpan perubahan Anda ke file **Echo.cs**.

#### <a name="task-3-test-the-http-triggered-function-by-using-httprepl"></a>Tugas 3: Menguji fungsi yang dipicu HTTP dengan menggunakan httprepl

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Jalankan perintah berikut untuk menjalankan proyek aplikasi fungsi:

    ```powershell
    func start --build
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [memulai proyek aplikasi fungsi secara lokal](https://docs.microsoft.com/azure/azure-functions/functions-develop-local) menggunakan **Azure Functions Core Tools**.
    
1. Pada taskbar, pilih ikon **Terminal Windows** lagi untuk membuka instans aplikasi baru. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori kosong **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```
    
1. Saat menerima perintah buka, jalankan perintah berikut untuk memulai alat **httprepl**, mengatur Pengidentifikasi Sumber Daya Seragam (URI) dasar ke ``http://localhost:7071``:

    ```powershell
    httprepl http://localhost:7071
    ```

    > **Catatan**: Pesan kesalahan ditampilkan oleh alat **httprepl**. Pesan ini terjadi karena alat sedang mencari file definisi Swagger yang akan digunakan untuk melintasi API. Karena proyek fungsi Anda tidak menghasilkan file definisi Swagger, Anda harus melintasi API secara manual.

1. Saat menerima perintah alat, jalankan perintah berikut untuk menelusuri ke direktori **api** relatif:

    ```powershell
    cd api
    ```

1. Jalankan perintah berikut untuk menelusuri ke direktori **echo** relatif:

    ```powershell
    cd echo
    ```

1. Jalankan perintah berikut untuk menjalankan perintah **posting**, mengirimkan isi permintaan HTTP yang diatur ke nilai numerik **3** dengan menggunakan **\-\-konten** pilihan:

    ```powershell
    post --content 3
    ```

1. Jalankan perintah berikut untuk menjalankan perintah **posting**, mengirimkan isi permintaan HTTP yang diatur ke nilai numerik **5** dengan menggunakan **\-\-konten** pilihan:

    ```powershell
    post --content 5
    ```

1. Jalankan perintah berikut untuk menjalankan perintah **posting**, mengirimkan isi permintaan HTTP yang diatur ke nilai string **Halo** dengan menggunakan **\-\-konten** pilihan:

    ```powershell
    post --content "Hello"
    ```

1. Jalankan perintah berikut untuk menjalankan perintah **posting**, mengirimkan isi permintaan HTTP yang diatur ke nilai JavaScript Object Notation (JSON) **{"msg": "Successful"}** dengan menggunakan opsi **\-\-konten**:

    ```powershell
    post --content "{"msg": "Successful"}"
    ```

1. Jalankan perintah berikut untuk keluar dari aplikasi **httprepl**:

    ```powershell
    exit
    ```

1. Tutup semua instans aplikasi **Terminal Windows** yang saat ini sedang berjalan.

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membuat fungsi dasar yang menggemakan konten yang dikirim melalui permintaan HTTP POST.

### <a name="exercise-4-create-a-function-that-triggers-on-a-schedule"></a>Latihan 4: Membuat fungsi yang dipicu sesuai jadwal

#### <a name="task-1-create-a-schedule-triggered-function"></a>Tugas 1: Membuat fungsi yang dipicu sesuai jadwal

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk menggunakan **Azure Functions Core Tools** guna membuat fungsi baru bernama **Recurring**, menggunakan template **Pemicu timer**:

    ```powershell
    func new --template "Timer trigger" --name "Recurring"
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [create a new function][azure-functions-core-tools-new-function] menggunakan **Azure Functions Core Tools**.
    
1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

#### <a name="task-2-observe-function-code"></a>Tugas 2: Mengamati kode fungsi

1. Pada layar **Mulai**, pilih petak peta **Visual Studio Code**.

1. Pada menu **File**, pilih **Buka Folder**.

1. Di jendela **File Explorer** yang terbuka, telusuri **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**, lalu **Pilih Folder**.

1. Pada panel **Penjelajah** dari jendela **Visual Studio Code**, buka file **Recurring.cs**.

1. Di editor kode, amati penerapannya:

    ```csharp
    using System;
    using Microsoft.Azure.WebJobs;
    using Microsoft.Azure.WebJobs.Host;
    using Microsoft.Extensions.Logging;
    namespace func
    {
        public static class Recurring
        {
            [FunctionName("Recurring")]
            public static void Run([TimerTrigger("0 */5 * * * *")]TimerInfo myTimer, ILogger log)
            {
                log.LogInformation($"C# Timer trigger function executed at: {DateTime.Now}");
            }
        }
    }
    ```

#### <a name="task-3-observe-function-runs"></a>Tugas 3: Mengamati eksekusi fungsi

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk menjalankan proyek aplikasi fungsi:

    ```powershell
    func start --build
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [start the function app project locally][azure-functions-core-tools-start-function] menggunakan **Azure Functions Core Tools**.

1. Amati eksekusi fungsi yang terjadi setiap lima menit. Setiap fungsi yang dijalankan harus merender pesan sederhana ke log.

1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

#### <a name="task-4-update-the-function-integration-configuration"></a>Tugas 4: Memperbarui konfigurasi integrasi fungsi

1. Pada layar **Mulai**, pilih petak peta **Visual Studio Code**.

1. Pada menu **File**, pilih **Buka Folder**.

1. Di jendela **File Explorer** yang terbuka, telusuri **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**, lalu **Pilih Folder**.

1. Pada panel **Penjelajah** dari jendela **Visual Studio Code**, buka file **Recurring.cs**.

1. Di editor kode, amati tanda tangan metode **Run** yang ada:

    ```csharp
    [FunctionName("Recurring")]
    public static void Run([TimerTrigger("0 */5 * * * *")]TimerInfo myTimer, ILogger log)
    ```

1. Perbarui blok kode tanda tangan metode **Run** untuk mengubah jadwal agar berjalan setiap **30 detik**:

    ```csharp
    [FunctionName("Recurring")]
    public static void Run([TimerTrigger("*/30 * * * * *")]TimerInfo myTimer, ILogger log)
    ```

1. Pilih **Simpan** untuk menyimpan perubahan Anda ke file **Recurring.cs**.

#### <a name="task-5-observe-function-runs"></a>Tugas 5: Mengamati eksekusi fungsi

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk menjalankan proyek aplikasi fungsi:

    ```powershell
    func start --build
    ```
    
    > **Catatan**: Anda dapat meninjau dokumentasi untuk [start the function app project locally][azure-functions-core-tools-start-function] menggunakan **Azure Functions Core Tools**.
    
1. Amati eksekusi fungsi yang terjadi setiap 30 detik. Setiap fungsi yang dijalankan harus merender pesan sederhana ke log.

1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

1. Tutup jendela Visual Studio Code.

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membuat fungsi yang berjalan secara otomatis berdasarkan jadwal tetap.

### <a name="exercise-5-create-a-function-that-integrates-with-other-services"></a>Latihan 5: Membuat fungsi yang terintegrasi dengan layanan lain

#### <a name="task-1-upload-sample-content-to-azure-blob-storage"></a>Tugas 1: Mengunggah konten sampel ke Azure Blob Storage

1. Di panel **navigasi** portal Microsoft Azure, pilih tautan **Grup sumber daya**.

1. Pada panel **Grup sumber daya**, pilih grup sumber daya **Tanpa server** yang Anda buat sebelumnya di lab ini.

1. Pada panel **Tanpa Server**, pilih akun penyimpanan **fungsi** _[namaanda]_ yang Anda buat sebelumnya di lab ini.

1. Pada panel **Akun penyimpanan**, pilih tautan **Kontainer** di bagian **Penyimpanan data**.

1. Di bagian **Kontainer**, pilih **+ Kontainer**.

1. Di jendela pop-up **Kontainer baru**, lakukan tindakan berikut, lalu pilih **Buat**:

    | Pengaturan                          | Tindakan                           |
    | -------------------------------- | -------------------------------- |
    | Kotak teks **Nama**  | Masukkan **konten**.     |
    | Daftar drop-down **Tingkat akses publik**  | Pilih **Privat (tanpa akses anonim)** .     |

1. Kembali ke bagian **Kontainer**, lalu pilih kontainer **konten** yang baru saja dibuat.

1. Pada panel **Kontainer**, pilih **Unggah**.

1. Di jendela **Unggah blob**, lakukan tindakan berikut, lalu pilih **Unggah**:

    | Pengaturan                          | Tindakan                           |
    | -------------------------------- | -------------------------------- |
    | Bagian **File**  | Pilih ikon **Folder**.    |
    | Jendela **File Explorer**  | Jelajahi **Allfiles (F):\\Allfiles\\Labs\\02\\Starter**, pilih file **settings.json**, lalu pilih **Buka**.    |
    | Kotak centang **Timpa jika file sudah ada**  | Pastikan kotak centang ini dipilih.   |

      > **Catatan**: Tunggu hingga blob diunggah sebelum Anda melanjutkan dengan lab ini.

#### <a name="task-2-create-an-http-triggered-function"></a>Tugas 2: Membuat fungsi yang dipicu HTTP

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk menggunakan **Azure Functions Core Tools** untuk membuat fungsi baru bernama **GetSettingInfo**, menggunakan template **pemicu HTTP**:

    ```powershell
    func new --template "HTTP trigger" --name "GetSettingInfo"
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [create a new function][azure-functions-core-tools-new-function] menggunakan **Azure Functions Core Tools**.

1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

#### <a name="task-3-register-azure-storage-blob-extensions"></a>Tugas 3: Mendaftarkan ekstensi Blob Azure Storage

1. Pada taskbar, pilih ikon **Terminal Windows**.
1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk mendaftarkan ekstensi [Microsoft.Azure.WebJobs.Extensions.Storage](https://www.nuget.org/packages/Microsoft.Azure.WebJobs.Extensions.Storage/4.0.4):

    ```powershell
    func extensions install --package Microsoft.Azure.WebJobs.Extensions.Storage --version 4.0.4
    ```

1. Jalankan perintah berikut untuk membangun proyek .NET dan untuk memvalidasi ekstensi yang diinstal dengan benar:

    ```powershell
    dotnet build
    ```

1. Tutup semua instans aplikasi **Terminal Windows** yang saat ini sedang berjalan.

1. #### <a name="task-4-write-http-triggered-and-blob-inputted-function-code"></a>Tugas 4: Menuulis kode fungsi yang dipicu HTTP dan dimasukkan blob

1. Pada layar **Mulai**, pilih petak peta **Visual Studio Code**.
1. Pada menu **File**, pilih **Buka Folder**.
1. Di jendela **File Explorer** yang terbuka, telusuri **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**, lalu **Pilih Folder**.
1. Pada panel **Penjelajah** pada jendela **Visual Studio Code**, buka file **GetSettingInfo.cs**.
1. Di penyunting kode, amati contoh penerapan:

    ```csharp
    using System;
    using System.IO;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    using Microsoft.Azure.WebJobs.Extensions.Http;
    using Microsoft.AspNetCore.Http;
    using Microsoft.Extensions.Logging;
    using Newtonsoft.Json;
    namespace func
    {
        public static class GetSettingInfo
        {
            [FunctionName("GetSettingInfo")]
            public static async Task<IActionResult> Run(
                [HttpTrigger(AuthorizationLevel.Function, "get", "post", Route = null)] HttpRequest req,
                ILogger log)
            {
                log.LogInformation("C# HTTP trigger function processed a request.");
                string name = req.Query["name"];
                string requestBody = await new StreamReader(req.Body).ReadToEndAsync();
                dynamic data = JsonConvert.DeserializeObject(requestBody);
                name = name ?? data?.name;
                string responseMessage = string.IsNullOrEmpty(name)
                    ? "This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response."
                    : $"Hello, {name}. This HTTP triggered function executed successfully.";
                return new OkObjectResult(responseMessage);
            }
        }
    }
    ```

1. Hapus semua konten dalam file **GetSettingInfo.cs**.

1. Tambahkan baris kode berikut untuk menambahkan **using directives** untuk **Microsoft.AspNetCore.Http**, **Microsoft.AspNetCore.Mvc**, dan namespace **Microsoft.Azure.WebJobs**:

    ```csharp
    using Microsoft.AspNetCore.Http;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    ```

1. Buat kelas **public static** baru bernama **GetSettingInfo**:

    ```csharp
    public static class GetSettingInfo
    { }
    ```

1. Amati kembali file **GetSettingInfo.cs**, yang sekarang harus menyertakan kode berikut:

    ```csharp
    using Microsoft.AspNetCore.Http;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    public static class GetSettingInfo
    { }
    ```

1. Dalam kelas **GetSettingInfo**, tambahkan blok kode berikut untuk membuat metode berisi ekspresi **public static** baru bernama **Run** yang mengembalikan variabel jenis **IActionResult**  dan yang juga menggunakan variabel jenis **HttpRequest** dan **string** sebagai parameter bernama *request* dan *json*:

    ```csharp
    public static IActionResult Run(
        HttpRequest request,
        string json)
        => null;
    ```

    > **Catatan**: Anda hanya mengatur sementara nilai pengembalian ke **null**.

1. Tambahkan kode berikut untuk menambahkan atribut ke metode **Run** jenis **FunctionNameAttribute** yang parameter **name**-nya diatur ke nilai **GetSettingInfo** :

    ```csharp
    [FunctionName("GetSettingInfo")]
    public static IActionResult Run(
        HttpRequest request,
        string json)
        => null;
    ```

1. Tambahkan kode berikut untuk menambahkan atribut ke parameter **request** jenis **HttpTriggerAttribute** yang memiliki kumpulan larik parameter **methods** yang diatur ke nilai tunggal **GET**:

    ```csharp
    [FunctionName("GetSettingInfo")]
    public static IActionResult Run(
        [HttpTrigger("GET")] HttpRequest request,
        string json)
        => null;
    ```

1. Tambahkan kode berikut untuk menambahkan atribut ke parameter **json** jenis **BlobAttribute** yang parameter **blobPath**-nya diatur ke nilai **content/settings. json**:

    ```csharp
    [FunctionName("GetSettingInfo")]
    public static IActionResult Run(
        [HttpTrigger("GET")] HttpRequest request,
        [Blob("content/settings.json")] string json)
        => null;
    ```

1. Tambahkan kode berikut untuk memperbarui metode berisi ekspresi **Run** untuk mengembalikan instans baru kelas **OkObjectResult** yang meneruskan nilai parameter metode **json** sebagai parameter konstruktor tunggal:

    ```csharp
    [FunctionName("GetSettingInfo")]
    public static IActionResult Run(
        [HttpTrigger("GET")] HttpRequest request,
        [Blob("content/settings.json")] string json)
        => new OkObjectResult(json);
    ```

1. Amati kembali file **GetSettingInfo.cs**, yang sekarang harus menyertakan kode berikut:

    ```csharp
    using Microsoft.AspNetCore.Http;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Azure.WebJobs;
    public static class GetSettingInfo
    {
        [FunctionName("GetSettingInfo")]
        public static IActionResult Run(
            [HttpTrigger("GET")] HttpRequest request,
            [Blob("content/settings.json")] string json)
            => new OkObjectResult(json);
    }
    ```

1. Pilih **Simpan** untuk menyimpan perubahan Anda ke file **GetSettingInfo.cs**.

#### <a name="task-5-test-the-function-by-using-httprepl"></a>Tugas 5: Menguji fungsi dengan menggunakan httprepl

1. Pada taskbar, pilih ikon **Terminal Windows**.

1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk menjalankan proyek aplikasi fungsi:

    ```powershell
    func start --build
    ```

    > **Catatan**: Anda dapat meninjau dokumentasi untuk [start the function app project locally][azure-functions-core-tools-start-function] menggunakan **Azure Functions Core Tools**.

1. Pada taskbar, pilih lagi ikon **Terminal Windows** untuk membuka instans baru aplikasi **Terminal Windows**.

1. Saat menerima perintah buka, jalankan perintah berikut untuk memulai alat **httprepl** yang mengatur Pengidentifikasi Sumber Daya Seragam (URI) dasar ke ``http://localhost:7071``:

    ```powershell
    httprepl http://localhost:7071
    ```

    > **Catatan**: Pesan kesalahan ditampilkan oleh alat **httprepl**. Pesan ini terjadi karena alat sedang mencari file definisi Swagger yang akan digunakan untuk melintasi API. Karena proyek fungsi Anda tidak menghasilkan file definisi Swagger, Anda harus melintasi API secara manual.

1. Saat menerima perintah alat, jalankan perintah berikut untuk menelusuri ke titik akhir **api** relatif:

    ```powershell
    cd api
    ```

1. Jalankan perintah berikut untuk menelusuri ke titik akhir **getsettinginfo** relatif:

    ```powershell
    cd getsettinginfo
    ```

1. Jalankan perintah berikut untuk menjalankan perintah **get** untuk titik akhir saat ini:

    ```powershell
    get
    ```

1. Amati konten JSON dari respons aplikasi fungsi, yang sekarang harus menyertakan:

    ```json
    {
        "version": "0.2.4",
        "root": "/usr/libexec/mews_principal/",
        "device": {
            "id": "21e46d2b2b926cba031a23c6919"
        },
        "notifications": {
            "email": "joseph.price@contoso.com",
            "phone": "(425) 555-0162 x4151"
        }
    }
    ```

1. Jalankan perintah berikut untuk keluar dari aplikasi **httprepl**:

    ```powershell
    exit
    ```

1. Tutup semua instans aplikasi **Terminal Windows** yang saat ini sedang berjalan.

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membuat fungsi yang mengembalikan konten file JSON di Penyimpanan.

### <a name="exercise-6-deploy-a-local-function-project-to-an-azure-functions-app"></a>Latihan 6: Menyebarkan proyek fungsi lokal ke aplikasi Azure Functions

#### <a name="task-1-deploy-using-the-azure-functions-core-tools"></a>Tugas 1: Menyebarkan menggunakan Azure Functions Core Tools

1. Pada taskbar, pilih ikon **Terminal Windows**.
1. Jalankan perintah berikut untuk mengubah direktori saat ini ke direktori **Allfiles (F):\\Allfiles\\Labs\\02\\Starter\\func**:

    ```powershell
    cd F:\Allfiles\Labs\02\Starter\func
    ```

1. Saat menerima perintah buka, jalankan perintah berikut untuk masuk ke antarmuka baris perintah Azure (CLI):

    ```powershell
    az login
    ```

1. Di jendela browser **Microsoft Edge**, masukkan alamat email dan sandi untuk akun Microsoft Anda, lalu pilih **Masuk**.

1. Kembali ke jendela **Terminal Windows** yang saat ini terbuka. Tunggu hingga proses masuk selesai.

1. Jalankan perintah berikut untuk menerbitkan proyek aplikasi fungsi:

    ```powershell
    func azure functionapp publish <function-app-name>
    ```

    > **Catatan**: Misalnya, jika **Nama Aplikasi Fungsi** Anda adalah **funclogicstudent**, perintah Anda adalah ``func azure functionapp publish funclogicstudent``. Anda dapat meninjau dokumentasi untuk [publish the local function app project][azure-functions-core-tools-publish-azure] menggunakan **Azure Functions Core Tools**.

1. Tunggu hingga penyebaran selesai sebelum Anda melanjutkan dengan lab.

1. Tutup aplikasi **Terminal Windows** yang sedang berjalan.

#### <a name="task-2-validate-deployment"></a>Tugas 2: Memvalidasi penyebaran

1. Pada taskbar, pilih ikon **Microsoft Edge**, dan pilih tab yang berisi portal Microsoft Azure (<https://portal.azure.com>).

1. Di panel **navigasi** portal Microsoft Azure, pilih tautan **Grup sumber daya**.

1. Pada panel **Grup sumber daya**, pilih grup sumber daya **Tanpa server** yang Anda buat sebelumnya di lab ini.

1. Pada panel **Tanpa Server**, pilih aplikasi fungsi **funclogic** _[namaanda]_ yang Anda buat sebelumnya di lab ini.

1. Pada panel **Aplikasi Fungsi**, pilih opsi **Functions** di bagian **Functions**.

1. Pada panel **Fungsi**, pilih fungsi **GetSettingInfo** yang ada.

1. Di panel **Fungsi**, pilih opsi **Kode + Uji** di bagian **Pengembang**.

1. Di editor fungsi, pilih **Uji/Jalankan**.

1. Pada dialog popup yang muncul, lakukan tindakan berikut: <!--Conan, as there is only sub step here, can we just combine the two as follows: In the popup dialog that appears, in the **HTTP method** list, select **GET**.-->
    - Di daftar **Metode HTTP**, pilih **GET**.

1. Pilih **Jalankan** untuk menguji fungsi.

1. Perhatikan hasil uji coba. Konten JSON sekarang akan menyertakan kode berikut:

    ```json
    {
        "version": "0.2.4",
        "root": "/usr/libexec/mews_principal/",
        "device": {
            "id": "21e46d2b2b926cba031a23c6919"
        },
        "notifications": {
            "email": "joseph.price@contoso.com",
            "phone": "(425) 555-0162 x4151"
        }
    }
    ```

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda menyebarkan proyek fungsi lokal ke Azure Functions dan memvalidasi bahwa fungsi tersebut berfungsi di Azure.

### <a name="exercise-7-clean-up-your-subscription"></a>Latihan 7: Membersihkan langganan Anda

#### <a name="task-1-open-azure-cloud-shell-and-list-resource-groups"></a>Tugas 1: Membuka Azure Cloud Shell dan daftar grup sumber daya

1.  Di portal Microsoft Azure, pilih ikon **Cloud Shell** ![ikon Cloud Shell](./media/az204_lab_CloudShell.png) untuk membuka sesi Bash baru. Jika Cloud Shell defaultnya diatur ke sesi PowerShell, pilih **PowerShell**, dan di menu dropdown, pilih **Bash**.

    > **Catatan**: Jika ini adalah pertama kalinya Anda memulai **Cloud Shell**, saat diminta untuk memilih **Bash** atau **PowerShell**, pilih **PowerShell**. Saat Anda melihat pesan **Anda tidak memiliki penyimpanan yang terpasang**, pilih langganan yang Anda gunakan di lab ini, lalu pilih **Buat penyimpanan**.

#### <a name="task-2-delete-a-resource-group"></a>Tugas 2: Menghapus grup sumber daya

1. Pada panel **Cloud Shell**, jalankan perintah berikut untuk menghapus grup sumber daya **Tanpa Server**:

    ```powershell
    az group delete --name Serverless --no-wait --yes
    ```

     > **Catatan**: Perintah dijalankan secara tidak sinkron (seperti yang ditentukan oleh parameter *--no-wait*), jadi sementara Anda dapat menjalankan perintah Azure CLI lain segera setelahnya dalam sesi Bash yang sama, perintah tersebut akan memerlukan waktu beberapa menit sebelum grup sumber daya dihapus.

1. Tutup panel **Cloud Shell** di portal.

#### <a name="task-3-close-the-active-application"></a>Tugas 3: Menutup aplikasi yang aktif

- Tutup aplikasi Microsoft Edge yang sedang berjalan.

#### <a name="review"></a>Tinjau

Dalam latihan ini, Anda membersihkan langganan Anda dengan menghapus grup sumber daya yang digunakan di lab ini.
